"use strict";!function(i){var s,c,a,r,l,p,d;i(document).on("click",".next-form",function(e){if(e.preventDefault(),!d){d=!0;var t=i(this),a=(i("#easybook-checkout-form")[0],!1),o=null;if(s=t.closest(".ck-fieldset-item"),(c=s.next(".ck-fieldset-item")).length){i(".ck-input-error").remove(),i(".inp-error").removeClass("inp-error");var n=s.find("input");n.length&&n.each(function(){var e=i(this);if("hidden"===e.prop("type")||!0===e.prop("disabled"))return!0;if(!0===e.prop("required")){if(""==e.val()&&("text"===e.prop("type")||"number"===e.prop("type")||"email"===e.prop("type")))return o=this,!(a=!0);if(!1===e.prop("checked")&&("checkbox"===e.prop("type")||"radio"===e.prop("type")))return o=this,!(a=!0)}}),a?(i(o).after('<span class="ck-input-error">'+o.validationMessage+"</span>"),i(o).addClass("inp-error"),d=!1):(i(".ck-input-error").remove(),i(".inp-error").removeClass("inp-error"),i(".ck-tab-item").removeClass("active"),i(".ck-tab-item").eq(i(".ck-fieldset-item").index(c)).addClass("active"),c.show(),s.animate({opacity:0},{step:function(e,t){p=1-.2*(1-e),r=50*e+"%",l=1-e,s.css({transform:"scale("+p+")",position:"absolute"}),c.css({left:r,opacity:l,position:"relative"})},duration:1200,complete:function(){s.hide(),d=!1},easing:"easeInOutBack"}))}}}),i(document).on("click",".back-form",function(e){if(e.preventDefault(),d)return!1;d=!0;var t=i(this);s=t.closest(".ck-fieldset-item"),a=t.closest(".ck-fieldset-item").prev(".ck-fieldset-item"),i(".ck-tab-item").removeClass("active"),i(".ck-tab-item").eq(i(".ck-fieldset-item").index(a)).addClass("active"),a.show(),s.animate({opacity:0},{step:function(e,t){p=.8+.2*(1-e),r=50*(1-e)+"%",l=1-e,s.css({left:r,position:"absolute"}),a.css({transform:"scale("+p+")",opacity:l,position:"relative"})},duration:1200,complete:function(){s.hide(),d=!1},easing:"easeInOutBack"})}),i(document).on("submit","#easybook-checkout-form",function(e){e.preventDefault();var t=new FormData(this),a=i(this),o=i(this).find(".lcheckout_btn");o.addClass("loading"),t.append("action","checkout_form"),i.ajax({type:"POST",url:_easybook_add_ons.url,dataType:"json",data:t,cache:!1,contentType:!1,processData:!1,success:function(e){e.success&&(o.removeClass("loading"),null!=e.url&&""!=e.url?window.location.href=e.url:i("#ck-tab-ck_confirm").length&&i("#ck-fieldset-ck_confirm").length?(i(".ck-tab-item").removeClass("active"),i("#ck-tab-ck_confirm").addClass("active"),i(".ck-fieldset-item").hide(),i("#ck-fieldset-ck_confirm").show().addClass("ck-fieldset-show")):null!=e.result&&""!=e.result&&(i("#ck-tab-ck_confirm").length&&(i(".ck-tab-item").removeClass("active"),i("#ck-tab-ck_confirm").addClass("active")),a.before(e.result),a.remove()))},error:function(e){console.log(e)}})}),i(document).on("change",'input[type="radio"][name="payment-method"]',function(e){e.preventDefault();var t=i(this).data("btn")||"",a=i(this).val(),o=i("#lcheckout_btn");t&&o.children(".btn-text").text(t),"stripe"===a?o.addClass("stripe-checkout"):o.removeClass("stripe-checkout")});var o=StripeCheckout.configure({key:_easybook_add_ons_payments.publishable_key,image:_easybook_add_ons_payments.logo,locale:"auto",currency:_easybook_add_ons_payments.currency_code,token:function(e){var t=i("#easybook-checkout-form");t.append('<input type="hidden" name="stripeToken" value="'+e.id+'">'),t.append('<input type="hidden" name="stripeEmail" value="'+e.email+'">'),t.submit()}});i(document).on("click","#lcheckout_btn",function(e){if(i(this).hasClass("stripe-checkout")){var t=i(this).data("payment");null!=t&&(t=i.extend({},{amount:5390,plan:"Basic",email:"",is_recurring:!1},JSON.parse(decodeURIComponent(t)))),o.open({name:_easybook_add_ons_payments.site_title,description:t.is_recurring?_easybook_add_ons_payments.recurring_text.replace("{{plan}}",t.plan):_easybook_add_ons_payments.one_time_text.replace("{{plan}}",t.plan),amount:t.amount,email:_easybook_add_ons_payments.use_email?t.email:""}),e.preventDefault()}}),window.addEventListener("popstate",function(){o.close()})}(jQuery);