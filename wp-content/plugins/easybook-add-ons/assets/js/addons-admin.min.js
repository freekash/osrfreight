"use strict";!function(c){var n={};function a(){c(".submitMap").each(function(){var e=c(this),t={lat:parseFloat(_easybook_add_ons_admin.center_lat),lng:parseFloat(_easybook_add_ons_admin.center_lng)};e.data("lat")&&e.data("lng")&&(t={lng:parseFloat(e.data("lng")),lat:parseFloat(e.data("lat"))});var a=new google.maps.Map(c(".submitMap")[0],{zoom:10,center:t,styles:[{featureType:"landscape",elementType:"all",stylers:[{color:"#f2f2f2"}]}]}),n=new google.maps.Marker({position:t,map:a,draggable:!0});n.addListener("dragend",function(e){c("#contact_infos_latitude").val(e.latLng.lat()),c("#contact_infos_longitude").val(e.latLng.lng())}),c(document).on("webkitfullscreenchange mozfullscreenchange fullscreenchange",function(){document.fullScreen||document.mozFullScreen||document.webkitIsFullScreen||a.setCenter(n.position)}),c(document).on("change","#contact_infos_latitude, #contact_infos_longitude",function(){var e=new google.maps.LatLng(c("#contact_infos_latitude").val(),c("#contact_infos_longitude").val());n.setPosition(e),a.setCenter(e)})})}n.hide=function(){c(".ctb-modal").fadeOut()},c(".ctb-modal-open").on("click",function(e){e.preventDefault(),c(".ctb-modal").fadeIn()}),c(".ctb-modal-close").on("click",function(){n.hide()}),c("#create-stripe-plan-form").on("submit",function(e){e.preventDefault();var t=c(this),a=t.serialize();c("#stripe_submit").attr("disabled",!0).addClass("submitted"),c.ajax({method:"POST",url:ajaxurl,data:a+"&action=create_stripe_plan"}).done(function(e){0==e.success?(void 0!==e.error&&t.before('<div class="stripe-plan-message">'+e.error+"</div>"),c("#stripe_submit").attr("disabled",!1).removeClass("submitted")):(void 0!==e.plan_id&&c("#_cth_stripe_plan_id").val(e.plan_id),n.hide(),t.remove())}).fail(function(e,t,a){console.log(e)})}),c(document).on("click",".repeater-fields-wrap .addfield",function(e){e.preventDefault();var t=c(this).closest(".repeater-fields-wrap"),a=t.children(".repeater-fields"),n=c(this).closest(".repeater-widgets-wrap"),i=c(this).data("index")?c(this).data("index"):a.children().length?a.children().length:0,l=c(this).data("parent-index")?c(this).data("parent-index"):void 0!==n?n.children(".repeater-widgets").children().length:1,s=void 0!==c(this).data("name")?c(this).data("name"):"add_widget_child_name",r=t.data("tmpl"),d=t.data("tmpl_data")?t.data("tmpl_data"):{},o=_.template(c("#"+r).html(),{variable:"data",evaluate:/<#([\s\S]+?)#>/g,interpolate:/{{{([\s\S]+?)}}}/g,escape:/{{([^}]+?)}}(?!})/g});a.append(o(c.extend({index:++i,parentindex:l,child_field_name:s},d))),c(this).data("index",i),c(this).data("parent-index",l)}),c(document).on("click",".repeater-fields-wrap .rmfield",function(e){e.preventDefault(),c(this).closest(".entry").remove()}),c(document).on("click",".repeater-widgets-wrap .addwidget",function(e){e.preventDefault();var t=c(this).closest(".repeater-widgets-wrap"),a=t.children(".repeater-widgets"),n=c(this).data("index")?c(this).data("index"):a.children().length?a.children().length:0,i=void 0!==c(this).data("name")?c(this).data("name"):"add_widget_name",l=t.data("tmpl"),s=t.data("tmpl_data")?t.data("tmpl_data"):{},r=_.template(c("#"+l).html(),{variable:"data",evaluate:/<#([\s\S]+?)#>/g,interpolate:/{{{([\s\S]+?)}}}/g,escape:/{{([^}]+?)}}(?!})/g});a.append(r(c.extend({index:++n,field_name:i},s))),c(this).data("index",n)}),c(document).on("click",".repeater-widgets-wrap .rmwidget",function(e){e.preventDefault();var t=null!=c(this).data("min")?c(this).data("min"):0;c(this).closest(".repeater-widgets-wrap").find(".entry").length>t&&c(this).closest(".entry").remove()}),c(document).on("click",".tabs-menu a",function(e){e.preventDefault();var t=c(this),a=t.attr("href");t.parent().addClass("current"),t.parent().siblings().removeClass("current"),t.closest(".tabs-wrapper").find(".tab-content").not(a).removeClass("current"),t.closest(".tabs-wrapper").find(a).addClass("current")}),c(function(){var e=document.getElementById("contact_infos_address");if(null!=e&&null!=e){var t=new google.maps.places.Autocomplete(e,{types:["geocode"]});t.addListener("place_changed",function(){var e=t.getPlace();c("#contact_infos_latitude").val(e.geometry.location.lat()).trigger("change"),c("#contact_infos_longitude").val(e.geometry.location.lng()).trigger("change")})}c(".submitMap").length&&google.maps.event.addDomListener(window,"load",a),c("#listing_expire_date").datetimepicker({formatDate:"Y-m-d",formatTime:"H:i:s",format:"Y-m-d H:i:s",allowBlank:!0}),c("#expiry_date").datetimepicker({formatDate:"Y-m-d",formatTime:"H:i:s",format:"Y-m-d H:i:s",allowBlank:!0})});var i="";c(document).on("click",".cth-addons-tab",function(e){e.preventDefault();var t=c(this);c(".cth-addons-tab").removeClass("nav-tab-active"),t.addClass("nav-tab-active"),c(".cth-addons-pane").removeClass("current"),c(t.attr("href")).addClass("current"),c('#ctb-addons-options-form input[name="_wp_http_referer"]').length&&(""==i&&(i=c('#ctb-addons-options-form input[name="_wp_http_referer"]').val()),i=i.replace(/&addonstab=\w*/gi,""),c('#ctb-addons-options-form input[name="_wp_http_referer"]').val(i+"&addonstab="+t.data("tabid")))}),c(function(){c(document).on("click",".set-lfeatured",function(e){e.preventDefault();var n=c(this),t={action:"admin_lfeatured",lid:c(this).data("id")},a=!1;n.hasClass("lfeatured")&&(a=!0,t.lfeatured=!0),n.addClass("do-process").attr("disabled",!0),c.ajax({method:"POST",url:ajaxurl,data:t}).done(function(e){e.success&&(a?n.removeClass("lfeatured"):n.addClass("lfeatured")),n.removeClass("do-process").attr("disabled",!1)}).fail(function(e,t,a){n.removeClass("do-process").attr("disabled",!1)})}),c("#claim_status").on("change",function(){"asked_charge"==c(this).val()?c("#claim_price_tr").addClass("claim-fee-asked"):c("#claim_price_tr").removeClass("claim-fee-asked")}),c(document).on("click",".set-lverified",function(e){e.preventDefault();var n=c(this),t={action:"admin_lverified",lid:c(this).data("id")},a=!1;n.hasClass("lverified")&&(a=!0,t.lverified=!0),n.addClass("do-process").attr("disabled",!0),c.ajax({method:"POST",url:ajaxurl,data:t}).done(function(e){e.success&&(a?n.removeClass("lverified"):n.addClass("lverified")),n.removeClass("do-process").attr("disabled",!1)}).fail(function(e,t,a){console.log(e),n.removeClass("do-process").attr("disabled",!1)})})})}(jQuery),function(s){function e(){s(".scroll-fixed-available").length&&s(".scroll-fixed-available").scrollToFixed({marginTop:32,minWidth:300,limit:function(){var e=s(".scroll-fixed-limit").offset().top-s(".scroll-fixed-available").outerHeight(!0);return e},removeOffsets:!0})}window.addEventListener("fieldsMounted",function(){return e()}),s(function(){var l;e(),s(".select-images-list").sortable(),s(".select-images-btn").on("click",function(e){e.preventDefault();var a=s(this),n=null==a.data("single")&&"toggle",i=s(this).data("field");(l=wp.media.frames.file_frame=wp.media({title:a.data("uploader_title"),button:{text:a.data("uploader_button_text")},multiple:n})).on("select",function(){if(n){l.state().get("selection").map(function(e){e=e.toJSON();var t=_.template(s("#tmpl-imageslist").html(),{variable:"data",evaluate:/<#([\s\S]+?)#>/g,interpolate:/{{{([\s\S]+?)}}}/g,escape:/{{([^}]+?)}}(?!})/g});a.closest(".select-images-wrap").children(".select-images-list").append(t(s.extend({},e,{field:i})))})}else{var e=l.state().get("selection").first().toJSON(),t=_.template(s("#tmpl-imageslist").html(),{variable:"data",evaluate:/<#([\s\S]+?)#>/g,interpolate:/{{{([\s\S]+?)}}}/g,escape:/{{([^}]+?)}}(?!})/g});a.closest(".select-images-wrap").children(".select-images-list").html(t(s.extend({},e,{field:i}))),"custom_avatar"==a.data("field")&&a.closest(".edit-profile-photo").children(".profile-photo-wrap").html('<img src="'+e.url+'" class="avatar avatar-150 photo">')}a.closest(".select-images-wrap").children(".select-images-list").sortable()}),l.open()}),s(document).on("click",".select-image-item",function(e){e.preventDefault();var n=s(this),a=s(this).data("field");(l=wp.media.frames.file_frame=wp.media({title:n.data("uploader_title"),button:{text:n.data("uploader_button_text")},multiple:!1})).on("select",function(){var e=l.state().get("selection").first().toJSON(),t=_.template(s("#tmpl-imageslist").html(),{variable:"data",evaluate:/<#([\s\S]+?)#>/g,interpolate:/{{{([\s\S]+?)}}}/g,escape:/{{([^}]+?)}}(?!})/g});n.replaceWith(t(s.extend({},e,{field:a})))}),l.on("open",function(){var e=l.state().get("selection"),t=n.children("input").data("id"),a=wp.media.attachment(t);a.fetch(),e.add(a?[a]:[])}),l.open()}),s(document).on("click",".remove-img-btn",function(e){e.preventDefault(),e.stopPropagation(),s(this).closest(".select-image-item").remove()}),s(".cth-color-field").each(function(){s(this).wpColorPicker()}),s(document).on("click",".get-curr-rate",function(e){e.preventDefault();var t=s(this);t.addClass("loading"),s.ajax({method:"POST",url:ajaxurl,data:{base:t.attr("data-base"),curr:t.attr("data-cur"),action:"get_curr_rate"}}).done(function(e){null!=e.debug&&!0===e.debug&&console.log(e),1==e.success&&null!=e.rate&&(t.closest(".entry").find(".curr-rate-input").val(e.rate),t.removeClass("loading"))})}),s(document).on("change",".currency-cur",function(e){var t=s(this).val();s(this).closest(".entry").find(".get-curr-rate").attr("data-cur",t)}),s(document).on("change",".base_currency_select",function(e){var t=s(this).val();""!=t&&s(".get-curr-rate").attr("data-base",t)})}),s(".date-picker").datetimepicker({formatDate:"Y-m-d",formatTime:"H:i:s",format:"Y-m-d H:i:s",allowBlank:!0})}(jQuery);